# Doxi – Doctor Online Appointment System

## Database Schema Documentation

This document describes the updated database schema for **Doxi – Doctor Online Appointment System**, covering the three main panels: **Admin, Doctor, and Patient**. The schema is designed for efficient appointment booking, chat messaging, prescription management, emergency assistance, notifications, reports, and audit logs.

---

## users
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| user_id      | INT, PK, AI         | Global user ID |
| name         | VARCHAR(100), NOT NULL | Full name |
| email        | VARCHAR(100), UNIQUE, NOT NULL | Used for login |
| password     | VARCHAR(255), NOT NULL | Hashed password |
| role         | ENUM('Admin','Doctor','Patient') | Decides panel after login |
| status       | ENUM('Active','Inactive') DEFAULT 'Active' | Account status |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Creation timestamp |

---

## patients
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| patient_id   | INT, PK, AI         | Unique patient ID |
| user_id      | INT, FK → users(user_id), UNIQUE, NOT NULL | Links to login user |
| gender       | ENUM('Male','Female','Other'), NOT NULL | Gender |
| dob          | DATE                | Date of birth |
| blood_group  | VARCHAR(5)          | Blood group type |
| marital_status | ENUM('Single','Married'), NULL | Marital status |
| phone        | VARCHAR(20)         | Phone number |
| emergency_contact_name | VARCHAR(100) | Emergency contact name |
| emergency_contact_no   | VARCHAR(20) | Emergency contact number |
| address      | TEXT                | Home address |
| height       | DECIMAL(5,2), NULL  | Height in cm |
| weight       | DECIMAL(5,2), NULL  | Weight in kg |
| occupation   | VARCHAR(100), NULL  | Occupation |
| profile_photo| VARCHAR(255) DEFAULT 'default_patient.png' | Profile photo |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |

---

## doctors
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| doctor_id    | INT, PK, AI         | Unique doctor ID |
| user_id      | INT, FK → users(user_id), UNIQUE, NOT NULL | Links to login user |
| profile_photo| VARCHAR(255) DEFAULT 'default_doctor.png' | Profile photo |
| gender       | ENUM('Male','Female','Other'), NOT NULL | Gender |
| dob          | DATE                | Date of birth |
| contact_no   | VARCHAR(20)         | Contact number |
| clinic_name  | VARCHAR(100)        | Clinic name |
| clinic_location | VARCHAR(255)     | Clinic location |
| specialization | VARCHAR(100)      | Specialization |
| qualification | VARCHAR(255)      | Qualifications |
| years_experience | INT             | Years of experience |
| registration_no | VARCHAR(50)      | Registration number |
| certificate_url | VARCHAR(255) DEFAULT 'default_certificate.png' | Certificate document |
| availability | TEXT                | **Redundant. Use doctor_availability instead** |
| rating       | DECIMAL(3,1) DEFAULT 0.0 | Doctor rating |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
| updated_at   | TIMESTAMP AUTO-UPDATE | Last updated |

---

## appointment_types
| Column              | Type                | Notes |
|---------------------|---------------------|-------|
| appointment_type_id | INT, PK, AI         | Unique ID |
| type_name           | VARCHAR(100), UNIQUE, NOT NULL | Type name |
| duration_minutes    | INT, NOT NULL       | Duration |
| description         | TEXT                | Description |

---

## appointments
| Column        | Type                | Notes |
|---------------|---------------------|-------|
| appointment_id| INT, PK, AI         | Unique appointment ID |
| patient_id    | INT, FK → patients(patient_id) | Patient reference |
| doctor_id     | INT, FK → doctors(doctor_id) | Doctor reference |
| appointment_type_id | INT, FK → appointment_types(appointment_type_id) | Appointment type |
| appointment_date | DATE, NOT NULL   | Appointment date |
| start_time    | TIME, NOT NULL      | Start time |
| end_time      | TIME, NOT NULL      | End time |
| status        | ENUM('Scheduled','Completed','Cancelled','Rescheduled','No-show') DEFAULT 'Scheduled' | Status |
| reason_for_visit | VARCHAR(255)     | Reason |
| created_at    | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
| updated_at    | TIMESTAMP AUTO-UPDATE | Updated timestamp |

---

## chats
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| chat_id      | INT, PK, AI         | Unique chat ID |
| sender_id    | INT, FK → users(user_id) | Message sender |
| receiver_id  | INT, FK → users(user_id) | Message receiver |
| appointment_id | INT, FK → appointments(appointment_id) | Optional link to appointment |
| message      | TEXT, NOT NULL      | Message content |
| sent_at      | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Sent timestamp |
| read_status  | ENUM('Read','Unread') DEFAULT 'Unread' | Read status |

---

## prescriptions
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| prescription_id | INT, PK, AI       | Unique prescription ID |
| appointment_id | INT, FK → appointments(appointment_id) | Linked appointment |
| patient_id   | INT, FK → patients(patient_id), NOT NULL | Patient reference |
| doctor_id    | INT, FK → doctors(doctor_id), NOT NULL | Doctor reference |
| disease      | VARCHAR(150)        | Disease |
| medicine_details | TEXT, NOT NULL   | Medicine details |
| instructions | TEXT                | Doctor instructions |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
| updated_at   | TIMESTAMP AUTO-UPDATE | Updated timestamp |

---

## reviews
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| review_id    | INT, PK, AI         | Unique review ID |
| patient_id   | INT, FK → patients(patient_id), NOT NULL | Reviewer |
| doctor_id    | INT, FK → doctors(doctor_id), NOT NULL | Doctor reviewed |
| appointment_id | INT, FK → appointments(appointment_id) | Appointment reference |
| rating       | TINYINT(1) CHECK (rating BETWEEN 1 AND 5) | Rating |
| comment      | TEXT                | Review text |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
| updated_at   | TIMESTAMP AUTO-UPDATE | Updated timestamp |

---

## doctor_availability
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| availability_id | INT, PK, AI       | Unique ID |
| doctor_id    | INT, FK → doctors(doctor_id), NOT NULL | Doctor reference |
| day_of_week  | ENUM('Monday'...'Sunday') NOT NULL | Day of week |
| start_time   | TIME, NOT NULL      | Start time |
| end_time     | TIME, NOT NULL      | End time |
| is_available | BOOLEAN DEFAULT TRUE | Availability |

---

## doctor_holidays
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| holiday_id   | INT, PK, AI         | Unique holiday ID |
| doctor_id    | INT, FK → doctors(doctor_id), NOT NULL | Doctor reference |
| holiday_date | DATE, NOT NULL      | Holiday date |
| reason       | VARCHAR(255)        | Reason |
| is_full_day  | BOOLEAN DEFAULT TRUE | Is full-day |

---

## emergency_requests
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| request_id   | INT, PK, AI         | Unique request ID |
| patient_id   | INT, FK → patients(patient_id) | Requesting patient |
| doctor_id    | INT, FK → doctors(doctor_id) | Assigned doctor |
| description  | TEXT                | Emergency issue |
| status       | ENUM('Pending','Accepted','Resolved','Cancelled') | Progress status |
| requested_at | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Request timestamp |
| resolved_at  | TIMESTAMP           | Resolution timestamp |

---

## notifications
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| notification_id | INT, PK, AI       | Unique notification ID |
| receiver_id  | INT, FK → users(user_id), NOT NULL | Receiver user |
| receiver_type| ENUM('Admin','Doctor','Patient') | Receiver type |
| sender_id    | INT, FK → users(user_id) | Sender user |
| sender_type  | ENUM('Admin','Doctor','Patient') | Sender type |
| title        | VARCHAR(255)        | Notification title |
| message      | TEXT, NOT NULL      | Message content |
| type         | ENUM('Email','Reminder','Message','System') | Notification type |
| related_id   | INT                 | Related entity |
| reminder_time| DATETIME            | Reminder time |
| delivery_status | ENUM('Pending','Sent') | Delivery status |
| read_status  | ENUM('Unread','Read') DEFAULT 'Unread' | Read status |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
| read_at      | TIMESTAMP           | Read timestamp |

---

## reports
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| report_id    | INT, PK, AI         | Unique report ID |
| patient_id   | INT, FK → patients(patient_id), NOT NULL | Patient reference |
| doctor_id    | INT, FK → doctors(doctor_id) | Doctor reference |
| file_path    | VARCHAR(255), NOT NULL | File path |
| report_type  | VARCHAR(100)        | Type of report |
| report_date  | DATE, NOT NULL      | Report date |
| report_status| ENUM('Active','Archived','Deleted') DEFAULT 'Active' | Report status |
| uploaded_by  | INT, FK → users(user_id) | Uploader reference |
| tags         | VARCHAR(255)        | Report tags |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
| updated_at   | TIMESTAMP AUTO-UPDATE | Updated timestamp |

---

## report_access_logs
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| log_id       | INT, PK, AI         | Unique log ID |
| report_id    | INT, FK → reports(report_id), NOT NULL | Report reference |
| user_id      | INT, FK → users(user_id), NOT NULL | User reference |
| access_time  | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Access time |
| action       | ENUM('View','Download','Share') | Action taken |
| ip_address   | VARCHAR(45)         | IP address |

---

## report_history
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| history_id   | INT, PK, AI         | Unique history ID |
| report_id    | INT, FK → reports(report_id), NOT NULL | Report reference |
| updated_by   | INT, FK → users(user_id), NOT NULL | Updated by |
| change_reason| VARCHAR(255)        | Reason for update |
| updated_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Updated timestamp |

---

## admin_logs
| Column       | Type                | Notes |
|--------------|---------------------|-------|
| log_id       | INT, PK, AI         | Unique log ID |
| admin_id     | INT, FK → users(user_id) | Admin performing action |
| action       | VARCHAR(255)        | Action performed |
| target_table | VARCHAR(100)        | Target table |
| target_id    | INT                 | Target record ID |
| ip_address   | VARCHAR(45)         | IP address |
| created_at   | TIMESTAMP DEFAULT CURRENT_TIMESTAMP | Created timestamp |
